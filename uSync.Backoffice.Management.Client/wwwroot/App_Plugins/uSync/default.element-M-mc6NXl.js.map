{"version":3,"file":"default.element-M-mc6NXl.js","sources":["../../../assets/src/workspace/views/default/default.element.ts"],"sourcesContent":["import { UmbElementMixin } from \"@umbraco-cms/backoffice/element-api\"\r\nimport { LitElement, css, customElement, html, nothing, property } from \"@umbraco-cms/backoffice/external/lit\";\r\n\r\nimport { USYNC_CORE_CONTEXT_TOKEN, uSyncWorkspaceContext } from '../../workspace.context.js';\r\nimport { SyncActionGroup, SyncHandlerSummary, uSyncActionView } from \"../../../api/index.js\";\r\n\r\n@customElement('usync-default-view')\r\nexport class uSyncDefaultViewElement extends UmbElementMixin(LitElement) {\r\n\r\n    #actionContext? : uSyncWorkspaceContext;\r\n    #contextLoaded: Boolean = false; \r\n\r\n    @property({ type: Array })\r\n    actions?: Array<SyncActionGroup>\r\n\r\n    @property({ type: Boolean })\r\n    loaded: Boolean = false;\r\n\r\n    @property({ type: Array  })\r\n    workingActions? : Array<SyncHandlerSummary>;\r\n\r\n    @property({ type: Boolean})\r\n    working: boolean = false; \r\n\r\n    @property({ type: Boolean})\r\n    completed: boolean = false; \r\n\r\n    @property({ type: Boolean}) \r\n    showProgress: boolean = false;\r\n\r\n    @property({ type: String}) \r\n    group: string = \"\";\r\n\r\n    @property({ type: Array})\r\n    results: Array<uSyncActionView> = [];\r\n\r\n    constructor() {\r\n        super();\r\n        console.log('element constructor');\r\n    }\r\n\r\n    #consumeContext() {\r\n\r\n        this.consumeContext(USYNC_CORE_CONTEXT_TOKEN, (_instance) => {\r\n            console.log('consume context');\r\n            this.#actionContext = _instance;\r\n\r\n            this.observe(_instance.actions, (_actions) => {\r\n                this.actions = _actions;\r\n                this.loaded = this.actions !== null;\r\n            });\r\n\r\n            this.observe(_instance.currentAction, (_currentAction) => {\r\n                this.workingActions = _currentAction;\r\n            });\r\n\r\n            this.observe(_instance.working, (_working) => {\r\n                this.working = _working;\r\n            });\r\n\r\n            this.observe(_instance.results, (_results) => {\r\n                this.results = _results;\r\n            })\r\n\r\n            this.observe(_instance.completed, (_completed) => {\r\n                this.completed = _completed;\r\n            });\r\n\r\n            this.observe(_instance.loaded, (_loaded) => {\r\n                if (_loaded && this.#contextLoaded == false) {\r\n                    this.#actionContext?.getActions();\r\n                    this.#contextLoaded\r\n                }\r\n            })\r\n\r\n        });\r\n\r\n    }\r\n\r\n\r\n    connectedCallback(): void {\r\n        super.connectedCallback();\r\n        console.log('connected');\r\n        this.#consumeContext();\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param event \r\n     */\r\n    performAction(event: CustomEventInit) {\r\n        this.showProgress = true;\r\n\r\n        console.log(event.detail);\r\n        this.group = event.detail.group;\r\n        this.#actionContext?.performAction(event.detail.group, event.detail.key);\r\n    }\r\n\r\n    render() {\r\n\r\n        if (this.loaded == false) {\r\n            return html`<uui-loader></uui-loader>`;\r\n        }\r\n        else {\r\n\r\n            console.log('element actions', this.actions?.length);\r\n\r\n            var actions = this.actions?.map((group) => {\r\n                return html`\r\n                <usync-action-box myName=\"fred\"\r\n                    .group=\"${group}\"\r\n                    @perform-action=${this.performAction}>\r\n                </usync-action-box>\r\n            `;\r\n            })\r\n\r\n            return html`\r\n                <div class=\"action-buttons-box\">\r\n                    ${actions}\r\n                </div>\r\n\r\n                ${this.#renderProcessBox()}\r\n\r\n                ${this.#renderReport()}\r\n            `;\r\n        }\r\n    };\r\n\r\n    #renderProcessBox() {\r\n        if (this.showProgress == false) return nothing;\r\n\r\n        console.log('element working actions', this.workingActions?.length);\r\n\r\n        return html`\r\n            <usync-progress-box .title=${this.group}\r\n                .actions=${this.workingActions}></usync-progress-box>\r\n        `;\r\n    }\r\n\r\n    #renderReport() {\r\n        if (this.completed == false) return nothing;\r\n\r\n        return html`\r\n            <uui-box>\r\n                <usync-results .results=${this.results}></usync-results>\r\n            </uui-box>\r\n        `\r\n    }\r\n\r\n    static styles = [\r\n        css`\r\n            usync-action-box, uui-box {\r\n               margin: var(--uui-size-space-4);\r\n            }\r\n\r\n            .action-buttons-box {\r\n               display: grid;\r\n               grid-template-columns: 1fr 1fr 1fr;\r\n            }        \r\n        `\r\n    ]\r\n}\r\n\r\nexport default uSyncDefaultViewElement;\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        'usync-default-view': uSyncDefaultViewElement\r\n    }\r\n}"],"names":["_actionContext","_contextLoaded","_consumeContext","consumeContext_fn","_renderProcessBox","renderProcessBox_fn","_renderReport","renderReport_fn","uSyncDefaultViewElement","UmbElementMixin","LitElement","__privateAdd","__privateMethod","event","_a","__privateGet","html","actions","_b","group","USYNC_CORE_CONTEXT_TOKEN","_instance","__privateSet","_actions","_currentAction","_working","_results","_completed","_loaded","nothing","css","__decorateClass","property","customElement","uSyncDefaultViewElement$1"],"mappings":"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"}